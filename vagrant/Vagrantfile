# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  # default options for all machines
  config.vm.box = "almalinux/centos-stream-9"
  config.ssh.insert_key = false
  # Host specific configuration:
  
  # router
  config.vm.define "router" do |router|
	  router.vm.hostname = "vtwireless.router"
	  router.vm.network "private_network", ip: "172.16.0.1",
			virtualbox__intnet: true,
			name: "lan"
	  router.vm.network "private_network", ip: "172.17.0.1",
			virtualbox__intnet: true,
			name: "dmz"
	  router.vm.network "private_network", type: "dhcp"
	end
  
  config.vm.define "infra" do |infra|
	  infra.vm.hostname = "vtwireless.infra"
	  infra.vm.network "private_network", ip: "172.16.0.3",
		virtualbox__intnet: true,
		name: "lan"
	end

  # Configure ansible provisioning here, inventory file is automatically generated by vagrant
  config.vm.provision "ansible" do |ansible|
	  ansible.playbook = "../playbooks/playbook.yml"
	  ansible.groups = {
		  "routers" => ["router"],
		  "dns" => ["router"],
		  "not_dns" => ["infra"],
		  "lan" => ["infra"],
		  "dmz" => []
	}
	end
	  
end
